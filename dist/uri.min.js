/*
 URI.js v1.3 (c) 2010 Gary Court. License: http://github.com/garycourt/uri-js
*/
if(typeof exports==="undefined")exports={};if(typeof require!=="function")require=function(){return exports};
(function(){function k(){this.errors=[]}function p(a){return a===undefined?"undefined":a===null?"null":Object.prototype.toString.call(a).split(" ").pop().split("]").shift().toLowerCase()}function v(a){for(var b="",c=0,d,g,C;c<a.length;){d=parseInt(a.substr(c+1,2),16);if(d<128){b+=String.fromCharCode(d);c+=3}else if(d>191&&d<224){g=parseInt(a.substr(c+4,2),16);b+=String.fromCharCode((d&31)<<6|g&63);c+=6}else{g=parseInt(a.substr(c+4,2),16);C=parseInt(a.substr(c+7,2),16);b+=String.fromCharCode((d&15)<<
12|(g&63)<<6|C&63);c+=9}}return b}function B(a){for(var b="",c=0,d;c<a.length;){d=parseInt(a.substr(c+1,2),16);if(d<128){d=String.fromCharCode(d);b+=d.match(I)?d:a.substr(c,3);c+=3}else if(d>191&&d<224){b+=a.substr(c,6);c+=6}else{b+=a.substr(c,9);c+=9}}return b}function m(a){a=a.charCodeAt(0);return a<128?"%"+a.toString(16).toUpperCase():a>127&&a<2048?"%"+(a>>6|192).toString(16).toUpperCase()+"%"+(a&63|128).toString(16).toUpperCase():"%"+(a>>12|224).toString(16).toUpperCase()+"%"+(a>>6&63|128).toString(16).toUpperCase()+
"%"+(a&63|128).toString(16).toUpperCase()}function e(a){return"(?:"+a+")"}function j(){for(var a=arguments[0],b=1,c=arguments[b];c;){a=a.slice(0,-1)+c.slice(1);c=arguments[++b]}return a}var l=j("[0-9]","[A-Fa-f]"),h=e("%"+l+l),n=j("[\\:\\/\\?\\#\\[\\]\\@]","[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),i=j("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]"),o=e("[A-Za-z]"+j("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),q=e(e(h+"|"+j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]"))+"*"),r=e(e("25[0-5]")+"|"+e("2[0-4][0-9]")+"|"+
e("1[0-9][0-9]")+"|"+e("[1-9][0-9]")+"|[0-9]");r=e(r+"\\."+r+"\\."+r+"\\."+r);var u=e(j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]")+"+");l=e("v"+l+"+\\."+j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]")+"+");l=e("\\["+e(u+"|"+l)+"\\]");u=e(e(h+"|"+j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"))+"*");r=e(l+"|"+r+"|"+u);l=e("[0-9]*");u=e(e(q+"@")+"?"+r+e("\\:"+l)+"?");var s=e(h+"|"+j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:\\@]")),t=e(s+"*"),w=e(s+"+"),x=e(e(h+"|"+j(i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",
"[\\@]"))+"+");t=e(e("\\/"+t)+"*");var y=e("\\/"+e(w+t)+"?");x=e(x+t);w=e(w+t);var z=e(""),A=e(e(s+"|[\\/\\?]")+"*");s=e(e(s+"|[\\/\\?]")+"*");var J=RegExp("^"+e("("+e(o+"\\:"+e(e("\\/\\/"+u+t)+"|"+y+"|"+w+"|"+z)+e("\\?"+A)+"?"+e("\\#"+s)+"?")+")|("+e(e(e("\\/\\/"+u+t)+"|"+y+"|"+x+"|"+z)+e("\\?"+A)+"?"+e("\\#"+s)+"?")+")")+"$"),K=RegExp("^("+o+")\\:"+e(e("\\/\\/("+e("("+q+")@")+"?("+r+")"+e("\\:("+l+")")+"?)")+"?("+t+"|"+y+"|"+w+"|"+z+")")+e("\\?("+A+")")+"?"+e("\\#("+s+")")+"?$"),L=RegExp("^(){0}"+
e(e("\\/\\/("+e("("+q+")@")+"?("+r+")"+e("\\:("+l+")")+"?)")+"?("+t+"|"+y+"|"+x+"|"+z+")")+e("\\?("+A+")")+"?"+e("\\#("+s+")")+"?$"),M=RegExp(j("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),N=RegExp(j("[^\\%\\:]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),O=RegExp(j("[^\\%]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),P=RegExp(j("[^\\%\\/\\:\\@]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),Q=RegExp(j("[^\\%\\/\\@]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),D=RegExp(j("[^\\%]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",
"[\\:\\@\\/\\?]"),"g"),R=RegExp(j("[^]",i,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),I=RegExp(i,"g");j("[^\\%]",i,n);var E=RegExp(h+"+","g"),S=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,F=/^\.\.?\//,G=/^\/\.(\/|$)/,H=/^\/\.\.(\/|$)/,T=/^\/?.*?(?=\/|$)/,U="".match(/(){0}/)[1]===undefined,f=exports;k.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,
reference:undefined,errors:undefined};f.a={};f.parse=function(a,b){var c,d=new k;a=a?a.toString():"";b=b||{};if(b.reference==="suffix")a=(b.scheme?b.scheme+":":"")+"//"+a;if(c=a.match(J))c=c[1]?a.match(K):a.match(L);if(!c){b.tolerant||d.errors.push("URI is not strictly valid.");c=a.match(S)}if(c){if(U){d.scheme=c[1];d.authority=c[2];d.userinfo=c[3];d.host=c[4];d.port=parseInt(c[5],10);d.path=c[6]||"";d.query=c[7];d.fragment=c[8];if(isNaN(d.port))d.port=c[5]}else{d.scheme=c[1]||undefined;d.authority=
a.indexOf("//")!==-1?c[2]:undefined;d.userinfo=a.indexOf("@")!==-1?c[3]:undefined;d.host=a.indexOf("//")!==-1?c[4]:undefined;d.port=parseInt(c[5],10);d.path=c[6]||"";d.query=a.indexOf("?")!==-1?c[7]:undefined;d.fragment=a.indexOf("#")!==-1?c[8]:undefined;if(isNaN(d.port))d.port=a.match(/\/\/.*\:(?:\/|\?|\#|$)/)?c[4]:undefined}d.reference=!d.scheme&&!d.authority&&!d.path&&!d.query?"same-document":d.scheme?d.fragment?"uri":"absolute":"relative";b.reference&&b.reference!=="suffix"&&b.reference!==d.reference&&
d.errors.push("URI is not a "+b.reference+" reference.");(c=f.a[(b.scheme||d.scheme||"").toLowerCase()])&&c.parse&&c.parse(d,b)}else d.errors.push("URI can not be parsed.");return d};f.e=function(a){var b=[];if(a.userinfo!==undefined||a.host!==undefined||typeof a.port==="number"){if(a.userinfo!==undefined){b.push(a.userinfo.toString().replace(N,m));b.push("@")}a.host!==undefined&&b.push(a.host.toString().toLowerCase().replace(O,m));if(typeof a.port==="number"){b.push(":");b.push(a.port.toString(10))}}return b.length?
b.join(""):undefined};f.b=function(a){for(var b=[],c;a.length;)if(a.match(F))a=a.replace(F,"");else if(a.match(G))a=a.replace(G,"/");else if(a.match(H)){a=a.replace(H,"/");b.pop()}else if(a==="."||a==="..")a="";else{c=a.match(T)[0];a=a.slice(c.length);b.push(c)}return b.join("")};f.serialize=function(a,b){var c=[],d;b=b||{};(d=f.a[(b.scheme||a.scheme||"").toLowerCase()])&&d.serialize&&d.serialize(a,b);if(b.reference!=="suffix"&&a.scheme){c.push(a.scheme.toString().toLowerCase().replace(M,""));c.push(":")}a.authority=
f.e(a);if(a.authority!==undefined){b.reference!=="suffix"&&c.push("//");c.push(a.authority);a.path&&a.path.charAt(0)!=="/"&&c.push("/")}if(a.path){d=f.b(a.path.toString().replace(/%2E/ig,"."));d=a.scheme?d.replace(P,m):d.replace(Q,m);if(a.authority===undefined)d=d.replace(/^\/\//,"/%2F");c.push(d)}if(a.query){c.push("?");c.push(a.query.toString().replace(D,m))}if(a.fragment){c.push("#");c.push(a.fragment.toString().replace(D,m))}return c.join("").replace(E,B).replace(/%[0-9A-Fa-f]{2}/g,function(g){return g.toUpperCase()})};
f.d=function(a,b,c,d){var g=new k;if(!d){a=f.parse(f.serialize(a,c),c);b=f.parse(f.serialize(b,c),c)}c=c||{};if(!c.tolerant&&b.scheme){g.scheme=b.scheme;g.authority=b.authority;g.userinfo=b.userinfo;g.host=b.host;g.port=b.port;g.path=f.b(b.path);g.query=b.query}else{if(b.authority!==undefined){g.authority=b.authority;g.userinfo=b.userinfo;g.host=b.host;g.port=b.port;g.path=f.b(b.path);g.query=b.query}else{if(b.path){if(b.path.charAt(0)==="/")g.path=f.b(b.path);else{g.path=a.authority!==undefined&&
!a.path?"/"+b.path:a.path?a.path.slice(0,a.path.lastIndexOf("/")+1)+b.path:b.path;g.path=f.b(g.path)}g.query=b.query}else{g.path=a.path;g.query=b.query!==undefined?b.query:a.query}g.authority=a.authority;g.userinfo=a.userinfo;g.host=a.host;g.port=a.port}g.scheme=a.scheme}g.fragment=b.fragment;return g};f.i=function(a,b,c){return f.serialize(f.d(f.parse(a,c),f.parse(b,c),c,true),c)};f.normalize=function(a,b){if(typeof a==="string")return f.serialize(f.parse(a,b),b);else if(p(a)==="object")return f.parse(f.serialize(a,
b),b);return a};f.f=function(a,b,c){if(typeof a==="string")a=f.serialize(f.parse(a,c),c);else if(p(a)==="object")a=f.serialize(a,c);if(typeof b==="string")b=f.serialize(f.parse(b,c),c);else if(p(b)==="object")b=f.serialize(b,c);return a===b};f.g=function(a){return a&&a.toString().replace(R,m)};f.j=function(a){return a&&a.toString().replace(E,v)};exports.h=m;exports.k=v;exports.Components=k;exports.c=f;exports.pctEncChar=m;exports.pctDecChars=v;exports.Components=k;exports.URI={SCHEMES:f.a,parse:f.parse,
removeDotSegments:f.b,serialize:f.serialize,resolveComponents:f.d,resolve:f.i,normalize:f.normalize,equal:f.f,escapeComponent:f.g,unescapeComponent:f.j}})();require("../uri").c.a.http={serialize:function(k){if(k.port===80)k.port=undefined;if(!k.path)k.path="/";return k}};(function(){var k=require("../uri"),p=k.c,v=k.h,B=/^urn\:((?:[0-9A-Za-z][0-9A-Za-z\-]{1,31}))$/,m=RegExp("^((?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31}))\\:((?:(?:(?:\\%[0-9A-Fa-f]{2})|[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#])+))$"),e=/^([^\:]+)\:(.*)/,j=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,l=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;p.a.urn={parse:function(h,n){var i=h.path.match(m),o,q;if(!i){n.tolerant||h.errors.push("URN is not strictly valid.");i=
h.path.match(e)}if(i){o="urn:"+i[1].toLowerCase();(q=p.a[o])||(q=p.a[o]={});if(!q.serialize)q.serialize=p.a.urn.serialize;h.scheme=o;h.path=i[2];q.parse&&q.parse(h,n)}else h.errors.push("URN can not be parsed.");return h},serialize:function(h,n){var i=h.scheme||n.scheme,o;if(i&&i!=="urn"){(o=i.match(B))||(o=["urn:"+i,i]);h.scheme="urn";h.path=o[1]+":"+(h.path?h.path.replace(j,v):"")}return h}};p.a["urn:uuid"]={parse:function(h,n){if(!n.tolerant&&(!h.path||!h.path.match(l)))h.errors.push("UUID is not valid.")},
serialize:function(h,n){if(!n.tolerant&&(!h.path||!h.path.match(l)))h.scheme=undefined;else h.path=(h.path||"").toLowerCase();return p.a.urn.serialize(h,n)}}})();
