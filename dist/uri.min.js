/*
 URI.js v1.5.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js
*/
if(typeof exports==="undefined")exports={};if(typeof require!=="function")require=function(){return exports};
URI=function(){function n(){this.errors=[]}function i(a){return a.toUpperCase()}function v(a){return a===undefined?"undefined":a===null?"null":Object.prototype.toString.call(a).split(" ").pop().split("]").shift().toLowerCase()}function u(a){for(var b="",c=0,d=a.length,g,l,w;c<d;){g=parseInt(a.substr(c+1,2),16);if(g<128){b+=String.fromCharCode(g);c+=3}else if(g>=194&&g<224){if(d-c>=6){l=parseInt(a.substr(c+4,2),16);b+=String.fromCharCode((g&31)<<6|l&63)}else b+=a.substr(c,6);c+=6}else if(g>=224){if(d-
c>=9){l=parseInt(a.substr(c+4,2),16);w=parseInt(a.substr(c+7,2),16);b+=String.fromCharCode((g&15)<<12|(l&63)<<6|w&63)}else b+=a.substr(c,9);c+=9}else{b+=a.substr(c,3);c+=3}}return b}function q(a){a=a.charCodeAt(0);return a<16?"%0"+a.toString(16).toUpperCase():a<128?"%"+a.toString(16).toUpperCase():a<2048?"%"+(a>>6|192).toString(16).toUpperCase()+"%"+(a&63|128).toString(16).toUpperCase():"%"+(a>>12|224).toString(16).toUpperCase()+"%"+(a>>6&63|128).toString(16).toUpperCase()+"%"+(a&63|128).toString(16).toUpperCase()}
function x(a){var b=j("[0-9]","[A-Fa-f]"),c=f(f("%[EFef]"+b+"%"+b+b+"%"+b+b)+"|"+f("%[89A-Fa-f]"+b+"%"+b+b)+"|"+f("%"+b+b)),d=j("[\\:\\/\\?\\#\\[\\]\\@]","[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),g=a?"[\\uE000-\\uF8FF]":"[]";a=j("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",a?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");var l=f("[A-Za-z]"+j("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),w=f(f(c+"|"+j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]"))+"*"),r=f(f("25[0-5]")+"|"+f("2[0-4][0-9]")+
"|"+f("1[0-9][0-9]")+"|"+f("[1-9][0-9]")+"|[0-9]");r=f(r+"\\."+r+"\\."+r+"\\."+r);var o=f(j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]")+"+");b=f("v"+b+"+\\."+j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:]")+"+");b=f("\\["+f(o+"|"+b)+"\\]");o=f(f(c+"|"+j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"))+"*");r=f(b+"|"+r+"|"+o);b=f("[0-9]*");o=f(c+"|"+j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:\\@]"));var t=f(o+"*"),y=f(o+"+"),z=f(f(c+"|"+j(a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\@]"))+"+");
t=f(f("\\/"+t)+"*");var A=f("\\/"+f(y+t)+"?");z=f(z+t);y=f(y+t);var B=f(""),C=f(f(o+"|"+j("[\\/\\?]",g))+"*");o=f(f(o+"|[\\/\\?]")+"*");return{p:RegExp("("+("^("+l+")\\:"+f(f("\\/\\/("+f("("+w+")@")+"?("+r+")"+f("\\:("+b+")")+"?)")+"?("+t+"|"+A+"|"+y+"|"+B+")")+f("\\?("+C+")")+"?"+f("\\#("+o+")")+"?$")+")|("+("^(){0}"+f(f("\\/\\/("+f("("+w+")@")+"?("+r+")"+f("\\:("+b+")")+"?)")+"?("+t+"|"+A+"|"+z+"|"+B+")")+f("\\?("+C+")")+"?"+f("\\#("+o+")")+"?$")+")"),m:RegExp(j("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),
"g"),n:RegExp(j("[^\\%\\:]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),i:RegExp(j("[^\\%]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),j:RegExp(j("[^\\%\\/\\:\\@]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),k:RegExp(j("[^\\%\\/\\@]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),"g"),l:RegExp(j("[^\\%]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:\\@\\/\\?]",g),"g"),h:RegExp(j("[^\\%]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]","[\\:\\@\\/\\?]"),"g"),d:RegExp(j("[^]",a,"[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]"),
"g"),o:RegExp(a,"g"),w:RegExp(j("[^\\%]",a,d),"g"),b:RegExp(c,"g")}}function f(a){return"(?:"+a+")"}function j(a){for(var b=a,c=1,d=arguments[c];d;){b=b.slice(0,-1)+d.slice(1);d=arguments[++c]}return b}var h=x(false),k=x(true),m=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n)*))?/i,p=/^\.\.?\//,s=/^\/\.(\/|$)/,D=/^\/\.\.(\/|$)/,E=/^\/?(?:.|\n)*?(?=\/|$)/,F="".match(/(){0}/)[1]===undefined,e=exports;n.prototype={scheme:undefined,userinfo:undefined,
host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};e.a={};e.f=function(a,b){function c(d){var g=u(d);return!g.match(b.o)?d:g}if(a.scheme)a.scheme=String(a.scheme).replace(b.b,c).toLowerCase().replace(b.m,"");if(a.userinfo!==undefined)a.userinfo=String(a.userinfo).replace(b.b,c).replace(b.n,q).replace(/%[0-9A-Fa-f]{2}/g,i);if(a.host!==undefined)a.host=String(a.host).replace(b.b,c).toLowerCase().replace(b.i,q).replace(/%[0-9A-Fa-f]{2}/g,
i);if(a.path!==undefined)a.path=String(a.path).replace(b.b,c).replace(a.scheme?b.j:b.k,q).replace(/%[0-9A-Fa-f]{2}/g,i);if(a.query!==undefined)a.query=String(a.query).replace(b.b,c).replace(b.l,q).replace(/%[0-9A-Fa-f]{2}/g,i);if(a.fragment!==undefined)a.fragment=String(a.fragment).replace(b.b,c).replace(b.h,q).replace(/%[0-9A-Fa-f]{2}/g,i)};e.parse=function(a,b){var c=h,d=new n;a=a?a.toString():"";b=b||{};if(b.iri)c=k;if(b.reference==="suffix")a=(b.scheme?b.scheme+":":"")+"//"+a;if(c=a.match(c.p))c=
c[1]?c.slice(1,10):c.slice(10,19);if(!c){b.tolerant||d.errors.push("URI is not strictly valid.");c=a.match(m)}if(c){if(F){d.scheme=c[1];d.userinfo=c[3];d.host=c[4];d.port=parseInt(c[5],10);d.path=c[6]||"";d.query=c[7];d.fragment=c[8];if(isNaN(d.port))d.port=c[5]}else{d.scheme=c[1]||undefined;d.userinfo=a.indexOf("@")!==-1?c[3]:undefined;d.host=a.indexOf("//")!==-1?c[4]:undefined;d.port=parseInt(c[5],10);d.path=c[6]||"";d.query=a.indexOf("?")!==-1?c[7]:undefined;d.fragment=a.indexOf("#")!==-1?c[8]:
undefined;if(isNaN(d.port))d.port=a.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?c[4]:undefined}d.reference=d.scheme===undefined&&d.userinfo===undefined&&d.host===undefined&&d.port===undefined&&d.path===undefined&&d.query===undefined?"same-document":d.scheme===undefined?"relative":d.fragment===undefined?"absolute":"uri";b.reference&&b.reference!=="suffix"&&b.reference!==d.reference&&d.errors.push("URI is not a "+b.reference+" reference.");c=e.a[(b.scheme||d.scheme||"").toLowerCase()];b.iri&&c&&!c.iri&&
e.f(d,h);c&&c.parse&&c.parse(d,b)}else d.errors.push("URI can not be parsed.");return d};e.q=function(a){var b=[];if(a.userinfo!==undefined){b.push(a.userinfo);b.push("@")}a.host!==undefined&&b.push(a.host);if(typeof a.port==="number"){b.push(":");b.push(a.port.toString(10))}return b.length?b.join(""):undefined};e.c=function(a){for(var b=[],c;a.length;)if(a.match(p))a=a.replace(p,"");else if(a.match(s))a=a.replace(s,"/");else if(a.match(D)){a=a.replace(D,"/");b.pop()}else if(a==="."||a==="..")a="";
else{c=a.match(E)[0];a=a.slice(c.length);b.push(c)}return b.join("")};e.serialize=function(a,b){var c=h,d=[],g,l;b=b||{};if(b.iri)c=k;(g=e.a[(b.scheme||a.scheme||"").toLowerCase()])&&g.serialize&&g.serialize(a,b);e.f(a,c);if(b.reference!=="suffix"&&a.scheme){d.push(a.scheme);d.push(":")}c=e.q(a,b);if(c!==undefined){b.reference!=="suffix"&&d.push("//");d.push(c);a.path&&a.path.charAt(0)!=="/"&&d.push("/")}if(a.path!==undefined){l=a.path;if(!b.absolutePath&&(!g||!g.absolutePath))l=e.c(l);if(c===undefined)l=
l.replace(/^\/\//,"/%2F");d.push(l)}if(a.query!==undefined){d.push("?");d.push(a.query)}if(a.fragment!==undefined){d.push("#");d.push(a.fragment)}return d.join("")};e.g=function(a,b,c,d){var g=new n;if(!d){a=e.parse(e.serialize(a,c),c);b=e.parse(e.serialize(b,c),c)}c=c||{};if(!c.tolerant&&b.scheme){g.scheme=b.scheme;g.userinfo=b.userinfo;g.host=b.host;g.port=b.port;g.path=e.c(b.path);g.query=b.query}else{if(b.userinfo!==undefined||b.host!==undefined||b.port!==undefined){g.userinfo=b.userinfo;g.host=
b.host;g.port=b.port;g.path=e.c(b.path);g.query=b.query}else{if(b.path){if(b.path.charAt(0)==="/")g.path=e.c(b.path);else{g.path=(a.userinfo!==undefined||a.host!==undefined||a.port!==undefined)&&!a.path?"/"+b.path:a.path?a.path.slice(0,a.path.lastIndexOf("/")+1)+b.path:b.path;g.path=e.c(g.path)}g.query=b.query}else{g.path=a.path;g.query=b.query!==undefined?b.query:a.query}g.userinfo=a.userinfo;g.host=a.host;g.port=a.port}g.scheme=a.scheme}g.fragment=b.fragment;return g};e.u=function(a,b,c){return e.serialize(e.g(e.parse(a,
c),e.parse(b,c),c,true),c)};e.normalize=function(a,b){if(typeof a==="string")a=e.serialize(e.parse(a,b),b);else if(v(a)==="object")a=e.parse(e.serialize(a,b),b);return a};e.r=function(a,b,c){if(typeof a==="string")a=e.serialize(e.parse(a,c),c);else if(v(a)==="object")a=e.serialize(a,c);if(typeof b==="string")b=e.serialize(e.parse(b,c),c);else if(v(b)==="object")b=e.serialize(b,c);return a===b};e.s=function(a,b){return a&&a.toString().replace(!b||!b.iri?h.d:k.d,q)};e.v=function(a,b){return a&&a.toString().replace(!b||
!b.iri?h.b:k.b,u)};exports.t=q;exports.z=u;exports.Components=n;exports.e=e;exports.pctEncChar=q;exports.pctDecChars=u;exports.Components=n;exports.URI={SCHEMES:e.a,parse:e.parse,removeDotSegments:e.c,serialize:e.serialize,resolveComponents:e.g,resolve:e.u,normalize:e.normalize,equal:e.r,escapeComponent:e.s,unescapeComponent:e.v};require("./schemes");return e}();(function(){var n=require("../uri").e;n.a.http=n.a.https={parse:function(i){i.host||i.errors.push("HTTP URIs must have a host.")},serialize:function(i){if(i.port===(i.scheme==="http"?80:443)||i.port==="")i.port=undefined;if(!i.path)i.path="/";return i}}})();(function(){var n=require("../uri"),i=n.e,v=n.t,u=/^urn\:((?:[0-9A-Za-z][0-9A-Za-z\-]{1,31}))$/,q=RegExp("^((?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31}))\\:((?:(?:(?:\\%[0-9A-Fa-f]{2})|[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#])+))$"),x=/^([^\:]+)\:(.*)/,f=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,j=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;i.a.urn={parse:function(h,k){var m=h.path.match(q),p,s;if(!m){k.tolerant||h.errors.push("URN is not strictly valid.");m=
h.path.match(x)}if(m){p="urn:"+m[1].toLowerCase();(s=i.a[p])||(s=i.a[p]={});if(!s.serialize)s.serialize=i.a.urn.serialize;h.scheme=p;h.path=m[2];s.parse&&s.parse(h,k)}else h.errors.push("URN can not be parsed.");return h},serialize:function(h,k){var m=h.scheme||k.scheme,p;if(m&&m!=="urn"){(p=m.match(u))||(p=["urn:"+m,m]);h.scheme="urn";h.path=p[1]+":"+(h.path?h.path.replace(f,v):"")}return h}};i.a["urn:uuid"]={parse:function(h,k){if(!k.tolerant&&(!h.path||!h.path.match(j)))h.errors.push("UUID is not valid.")},
serialize:function(h,k){if(!k.tolerant&&(!h.path||!h.path.match(j)))h.scheme=undefined;else h.path=(h.path||"").toLowerCase();return i.a.urn.serialize(h,k)}}})();
